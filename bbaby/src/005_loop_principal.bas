' LOOP PRINCIPAL DO  JOGO
3000 ' LOOP PRINCIPAL DO  JOGO
3010 TB = 16: Y = ((BY - 3) * 8) - 1: X = BX * 8
3020 PUT SPRITE 0,(X, Y), 1, TB
3030 PUT SPRITE 1,(X + 8, Y), 1, TB + 1
3040 PUT SPRITE 2,(X, Y + 16), 1, TB + 2
3050 PUT SPRITE 3,(X + 8, Y + 16), 1, TB + 3
3060 PUT SPRITE 4,(X, Y + 16), 9, TB + 4
3070 PUT SPRITE 5,(X + 8, Y + 16), 9, TB + 5
3100 RETURN

' POSICAO DO PE DO BABY
3110 E0 = (BX + 32 * BY): RETURN
3120 GOSUB 3110: E1 = VPEEK(BASE(5) + E0): RETURN:  REM PES
3130 GOSUB 3110: E1 = VPEEK(BASE(5) + E0 + 2): RETURN: REM PAREDE NA DIREITA
3140 GOSUB 3110: E1 = VPEEK(BASE(5) + E0): RETURN: REM PAREDE NA ESQUERDA

' POSICAO X,Y DO BABY. BB=DIRECAO: 0:DIREITA, 1:ESQUERDA.
' BX = 15 * 8
' BY = 17 * 8
' BB = 1 
' TRAGE DO BABY: 16,22=DIREITA, 28,34=ESQUERDA, 40=SUBINDO 1, 46=SUBINDO 2.

3200 ' POSICIONA SPRITE BABY PARA DIREITA
3201 TB = 16: Y = ((BY - 3) * 8) - 1: X = BX * 8
3205 FOR G = 0 TO 1
3206    FOR F = 1 TO 4 
3210        PUT SPRITE 0,(X + F, Y), 1, TB
3220        PUT SPRITE 1,(X + F + 8, Y), 1, TB + 1
3230        PUT SPRITE 2,(X + F, Y + 16), 1, TB + 2
3240        PUT SPRITE 3,(X + F + 8, Y + 16), 1, TB + 3
3250        PUT SPRITE 4,(X + F, Y + 16), 9, TB + 4
3260        PUT SPRITE 5,(X + F + 8, Y + 16), 9, TB + 5
3265    NEXT F 
3266    X = X + 4
3270    IF TB = 22 THEN TB = 16 ELSE IF TB = 16 THEN TB = 22
3280 NEXT G: BX = BX + 1
3290 RETURN

3300 ' POSICIONA SPRITE BABY PARA ESQUERDA
3310 TB = 28: Y = ((BY - 3) * 8) - 1: X = BX * 8
3320 FOR G = 0 TO 1
3330    FOR F = 4 TO 1 STEP - 1 
3340        PUT SPRITE 0,(X + F, Y), 1, TB
3350        PUT SPRITE 1,(X + F + 8, Y), 1, TB + 1
3360        PUT SPRITE 2,(X + F, Y + 16), 1, TB + 2
3370        PUT SPRITE 3,(X + F + 8, Y + 16), 1, TB + 3
3380        PUT SPRITE 4,(X + F, Y + 16), 9, TB + 4
3390        PUT SPRITE 5,(X + F + 8, Y + 16), 9, TB + 5
3400    NEXT F 
3410    X = X - 4
3420    IF TB = 34 THEN TB = 28 ELSE IF TB = 28 THEN TB = 34
3430 NEXT G: BX = BX - 1
3440 RETURN

3450 ' POSICIONA SPRITE BABY PARA CIMA
3460 TB = 40: Y = ((BY - 3) * 8) - 1: X = BX * 8
3470 FOR G = 8 TO 1 STEP - 1
3480    FOR F = 4 TO 1 STEP -1 
3490        PUT SPRITE 0,(X, Y), 1, TB
3500        PUT SPRITE 1,(X + 8, Y), 1, TB + 1
3510        PUT SPRITE 2,(X, Y + 16), 1, TB + 2
3520        PUT SPRITE 3,(X + 8, Y + 16), 1, TB + 3
3530        PUT SPRITE 4,(X, Y + 16), 9, TB + 4
3540        PUT SPRITE 5,(X + 8, Y + 16), 9, TB + 5
3550    NEXT F 
3560    Y = Y - 6
3570    IF TB = 40 THEN TB = 46 ELSE IF TB = 46 THEN TB = 40
3580 NEXT G: BY = BY - 6
3590 RETURN

3600 ' POSICIONA SPRITE BABY PARA BAIXO
3610 TB = 40: Y = ((BY - 3) * 8) - 1: X = BX * 8
3620 FOR G = 1 TO 8 
3630    FOR F = 1 TO 4
3640        PUT SPRITE 0,(X, Y), 1, TB
3650        PUT SPRITE 1,(X + 8, Y), 1, TB + 1
3660        PUT SPRITE 2,(X, Y + 16), 1, TB + 2
3670        PUT SPRITE 3,(X + 8, Y + 16), 1, TB + 3
3680        PUT SPRITE 4,(X, Y + 16), 9, TB + 4
3690        PUT SPRITE 5,(X + 8, Y + 16), 9, TB + 5
3700    NEXT F 
3710    Y = Y + 6
3720    IF TB = 40 THEN TB = 46 ELSE IF TB = 46 THEN TB = 40
3730 NEXT G: BY = BY + 6
3740 RETURN


4000 ' GELEIA: ' TRAGE DO SPRITE: 0=GELEIA DIREITA, 8=GELEIA ESQUERDA. TT: MOVIMENTA SPRITE.
4005 TR = 8:
4010    PUT SPRITE 10,(GX + F, GY), 1, TR
4020    PUT SPRITE 11,(GX + F + 8, GY), 1, TR + 1
4030    PUT SPRITE 12,(GX + F, GY + 16), 1, TR + 2
4040    PUT SPRITE 13,(GX + F + 8, GY + 16), 1, TR + 3
4050    PUT SPRITE  6,(GX + F, GY), 2, TR + 4
4060    PUT SPRITE  7,(GX + F + 8, GY), 2, TR + 5
4070    PUT SPRITE  8,(GX + F, GY + 16), 2, TR + 6
4080    PUT SPRITE  9,(GX + F + 8, GY + 16), 2, TR + 7
4100 RETURN


5000 ' MOVIMENTOS
5010 '
5020 JO=STICK(0)
5030 ' 
5040 IF JO=3 THEN GOSUB 5100 ELSE IF JO=7 THEN GOSUB 5200 ELSE IF JO=1 THEN GOSUB 5300 ELSE IF JO=5 THEN GOSUB 5400
5050 GOTO 5020

5100 ' MOVIMENTO PARA DIREITA
5110 BB = 1
5120 GOSUB 3130: ' LE A POSICAO DO PE DO BABY.
5130 IF BX > 28 GOSUB 5500
5140 IF E1 = 37 THEN RETURN
5150 LOCATE 0, 1: PRINT "PES: X: "; BX; " Y: "; BY; CHR$(E1); E1: REM ; "5"; CHR$(E5); E5; "7"; CHR$(E7); E7; "3"; CHR$(E3); E3
5160 GOSUB 3200
5170 RETURN

5200 ' MOVIMENTO PARA ESQUERDA
5210 BB = -1
5220 GOSUB 3140: ' LE A POSICAO DO PE DO BABY.
5230 IF BX < 1 GOSUB 5500
5240 IF E1 = 37 THEN RETURN
5250 LOCATE 0, 1: PRINT "PES: X: "; BX; " Y: "; BY; CHR$(E1); E1: REM ; "5"; CHR$(E5); E5; "7"; CHR$(E7); E7; "3"; CHR$(E3); E3
5260 GOSUB 3300
5270 RETURN

5300 ' MOVIMENTO PARA CIMA
5310 GOSUB 3120
5320 LOCATE 0, 1: PRINT "PES: X: "; BX; " Y: "; BY; CHR$(E1); E1: REM ; "5"; CHR$(E5); E5; "7"; CHR$(E7); E7; "3"; CHR$(E3); E3
5340 GOSUB 3450: GOSUB 3000
5350 RETURN

5400 ' MOVIMENTO PARA BAIXO
5410 GOSUB 3120
5420 LOCATE 0, 1: PRINT "PES: X: "; BX; " Y: "; BY; CHR$(E1); E1: REM ; "5"; CHR$(E5); E5; "7"; CHR$(E7); E7; "3"; CHR$(E3); E3
5430 GOSUB 3600: GOSUB 3000
5440 RETURN

5500 ' MUDA CENARIO
5510 LOCATE 0,0: PRINT "POSICAO:"; BX; "CENARIO:"; SC
5520 IF SC = 2 AND STICK(0) = 3 THEN SC = 3: GOSUB 6000: BX = 0: GOSUB 3000: RETURN
5530 IF SC = 1 AND STICK(0) = 3 THEN SC = 2: GOSUB 6000: BX = 0: GOSUB 3000: RETURN
5540 IF SC = 3 AND STICK(0) = 7 THEN SC = 2: GOSUB 6000: BX = 30: GOSUB 3000: RETURN
5550 IF SC = 2 AND STICK(0) = 7 THEN SC = 1: GOSUB 6000: BX = 30: GOSUB 3000: RETURN
5560 RETURN


